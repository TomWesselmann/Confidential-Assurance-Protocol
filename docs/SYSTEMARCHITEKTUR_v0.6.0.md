# ğŸ—ï¸ LkSG Proof Agent â€“ v0.6.0 Systemarchitektur

**Version:** 0.6.0 (P0 + P1 + P2 â€“ Timestamp & Registry Integration)
**Datum:** 2025-10-29
**Status:** MVP Complete âœ…

---

## ğŸ“‹ Inhaltsverzeichnis

1. [Gesamtarchitektur](#gesamtarchitektur)
2. [Schichtenmodell](#schichtenmodell)
3. [Modul-Ãœbersicht](#modul-Ã¼bersicht)
4. [Registry & Timestamp-Architektur](#registry--timestamp-architektur)
5. [Lists-Architektur (Sanctions/Jurisdictions)](#lists-architektur-sanctionsjurisdictions)
6. [Datenfluss-Diagramme](#datenfluss-diagramme)
7. [CLI-Kommando-Flow](#cli-kommando-flow)
8. [Datenformate](#datenformate)
9. [Test-Coverage](#test-coverage)
10. [Zusammenfassung](#zusammenfassung)

---

## ğŸ›ï¸ Gesamtarchitektur

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LkSG Proof Agent v0.6.0                         â”‚
â”‚    Offline Compliance Proof System (P0+P1+P2) â˜… REGISTRY â˜…        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          INPUT LAYER                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   CSV Data  â”‚  â”‚    Policy    â”‚  â”‚    Keys    â”‚  â”‚  Lists   â”‚ â”‚
â”‚  â”‚             â”‚  â”‚   (YAML/JSON)â”‚  â”‚ (Ed25519)  â”‚  â”‚  (CSV)   â”‚ â”‚
â”‚  â”‚ â€¢ Suppliers â”‚  â”‚              â”‚  â”‚            â”‚  â”‚          â”‚ â”‚
â”‚  â”‚ â€¢ UBOs      â”‚  â”‚ â€¢ lksg.v1    â”‚  â”‚ â€¢ Private  â”‚  â”‚ â€¢ Sanctioâ”‚ â”‚
â”‚  â”‚             â”‚  â”‚ â€¢ Constraintsâ”‚  â”‚ â€¢ Public   â”‚  â”‚ â€¢ Jurisdicâ”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                â”‚                 â”‚              â”‚       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚                 â”‚              â”‚
          â–¼                â–¼                 â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    COMMITMENT ENGINE (P0)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  io.rs â€“ CSV Parser                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚ â”‚
â”‚  â”‚  â”‚   Suppliers   â”‚          â”‚      UBOs     â”‚               â”‚ â”‚
â”‚  â”‚  â”‚  (name, jur.) â”‚          â”‚ (name, birth) â”‚               â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚                          â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  commitment.rs â€“ BLAKE3 Merkle Root Computation             â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Commitments {                                               â”‚ â”‚
â”‚  â”‚    supplier_root,                                            â”‚ â”‚
â”‚  â”‚    ubo_root,                                                 â”‚ â”‚
â”‚  â”‚    company_commitment_root,                                  â”‚ â”‚
â”‚  â”‚    supplier_count,                                           â”‚ â”‚
â”‚  â”‚    ubo_count                                                 â”‚ â”‚
â”‚  â”‚  }                                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  audit.rs â€“ SHA3-256 Hash Chain                             â”‚ â”‚
â”‚  â”‚  Event Chain: E0 â†’ E1 â†’ E2 â†’ ... â†’ En                       â”‚ â”‚
â”‚  â”‚  â€¢ get_tip() â†’ current chain head                           â”‚ â”‚
â”‚  â”‚  â€¢ write_tip() / read_tip() for timestamping â˜… P0 â˜…         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ commitments.json  â”‚ â† OUTPUT (P0)
      â”‚ + counts          â”‚
      â”‚ + audit.head      â”‚ â˜… NEW P0 â˜…
      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       POLICY LAYER (P0)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  policy.rs â€“ Policy Validator                                â”‚ â”‚
â”‚  â”‚  validate(policy) â†’ constraints                              â”‚ â”‚
â”‚  â”‚  â€¢ ubo_count_min (optional) â˜… P0 â˜…                           â”‚ â”‚
â”‚  â”‚  â€¢ require_statement_roots (optional) â˜… P0 â˜…                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  manifest.rs â€“ Manifest Builder                             â”‚ â”‚
â”‚  â”‚  Manifest {                                                  â”‚ â”‚
â”‚  â”‚    policy, commitments, audit, signatures,                   â”‚ â”‚
â”‚  â”‚    time_anchor: Option<TimeAnchor> â˜… P0 â˜…                    â”‚ â”‚
â”‚  â”‚  }                                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  sign.rs â€“ Ed25519 Digital Signature                        â”‚ â”‚
â”‚  â”‚  sign_manifest(manifest, privkey) â†’ signature               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  manifest.json    â”‚ â† OUTPUT (P0)
      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LISTS LAYER (P1) â˜… NEW â˜…                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  lists/sanctions.rs â€“ Sanctions List Processing             â”‚ â”‚
â”‚  â”‚  â€¢ SanctionsEntry: (name, birthdate, nationality)           â”‚ â”‚
â”‚  â”‚  â€¢ compute_sanctions_root(csv) â†’ (root, entries)            â”‚ â”‚
â”‚  â”‚  â€¢ BLAKE3 Merkle Root fÃ¼r Sanctions-Hashes                  â”‚ â”‚
â”‚  â”‚  â€¢ save_sanctions_root_info() â†’ sanctions.root              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  lists/jurisdictions.rs â€“ Jurisdiction List Processing      â”‚ â”‚
â”‚  â”‚  â€¢ JurisdictionEntry: (iso_code, risk_level)                â”‚ â”‚
â”‚  â”‚  â€¢ compute_jurisdictions_root(csv) â†’ (root, entries)        â”‚ â”‚
â”‚  â”‚  â€¢ BLAKE3 Merkle Root fÃ¼r Jurisdiction-Hashes               â”‚ â”‚
â”‚  â”‚  â€¢ save_jurisdictions_root_info() â†’ jurisdictions.root      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  sanctions.root   â”‚ â† OUTPUT (P1)
      â”‚  jurisdictions.rootâ”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ZERO-KNOWLEDGE LAYER (P1)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  zk_system.rs â€“ Zero-Knowledge Proof System                 â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Statement {                                                 â”‚ â”‚
â”‚  â”‚    policy_hash,                                              â”‚ â”‚
â”‚  â”‚    company_commitment_root,                                  â”‚ â”‚
â”‚  â”‚    constraints[],                                            â”‚ â”‚
â”‚  â”‚    sanctions_root: Option<String> â˜… P0+P1 â˜…                 â”‚ â”‚
â”‚  â”‚    jurisdiction_root: Option<String> â˜… P0+P1 â˜…              â”‚ â”‚
â”‚  â”‚  }                                                           â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Witness {                                                   â”‚ â”‚
â”‚  â”‚    suppliers[], ubos[],                                      â”‚ â”‚
â”‚  â”‚    supplier_count, ubo_count,                                â”‚ â”‚
â”‚  â”‚    sanctions_list: Option<Vec<String>> â˜… P1 â˜…               â”‚ â”‚
â”‚  â”‚  }                                                           â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Constraints:                                                â”‚ â”‚
â”‚  â”‚  â€¢ require_at_least_one_ubo                                  â”‚ â”‚
â”‚  â”‚  â€¢ supplier_count_max                                        â”‚ â”‚
â”‚  â”‚  â€¢ sanctions_non_membership â˜… P1 â˜…                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  zk_proof.dat     â”‚ â† OUTPUT (P1)
      â”‚  zk_proof.json    â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              REGISTRY & TIMESTAMP LAYER (P2) â˜… NEW â˜…               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  registry.rs â€“ Proof Registry & Timestamping                â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Registry {                                                  â”‚ â”‚
â”‚  â”‚    registry_version: "1.0",                                  â”‚ â”‚
â”‚  â”‚    entries: [RegistryEntry]                                  â”‚ â”‚
â”‚  â”‚  }                                                           â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  RegistryEntry {                                             â”‚ â”‚
â”‚  â”‚    id: "proof_001",                                          â”‚ â”‚
â”‚  â”‚    manifest_hash: "0x...",                                   â”‚ â”‚
â”‚  â”‚    proof_hash: "0x...",                                      â”‚ â”‚
â”‚  â”‚    timestamp_file: Option<String>,                           â”‚ â”‚
â”‚  â”‚    registered_at: "RFC3339"                                  â”‚ â”‚
â”‚  â”‚  }                                                           â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Timestamp {                                                 â”‚ â”‚
â”‚  â”‚    version: "tsr.v1",                                        â”‚ â”‚
â”‚  â”‚    audit_tip_hex: "0x...",                                   â”‚ â”‚
â”‚  â”‚    created_at: "RFC3339",                                    â”‚ â”‚
â”‚  â”‚    tsa: "local-mock",                                        â”‚ â”‚
â”‚  â”‚    signature: "hex(SHA3(tip+ts))",                           â”‚ â”‚
â”‚  â”‚    status: "ok"                                              â”‚ â”‚
â”‚  â”‚  }                                                           â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Functions:                                                  â”‚ â”‚
â”‚  â”‚  â€¢ compute_file_hash(path) â†’ SHA3-256                        â”‚ â”‚
â”‚  â”‚  â€¢ Timestamp::create_mock(audit_tip) â†’ Timestamp            â”‚ â”‚
â”‚  â”‚  â€¢ Timestamp::verify(audit_tip) â†’ bool                       â”‚ â”‚
â”‚  â”‚  â€¢ Registry::add_entry() â†’ id                                â”‚ â”‚
â”‚  â”‚  â€¢ Registry::verify_entry() â†’ bool                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  registry.json    â”‚ â† OUTPUT (P2)
      â”‚  timestamp.tsr    â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      VERIFIER                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  verifier.rs â€“ Offline Proof Package Verifier               â”‚ â”‚
â”‚  â”‚  verify(package) â†’ VerificationResult                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Verification      â”‚ â† OUTPUT (Console)
      â”‚ Results           â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Schichtenmodell

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 7: CLI Interface (main.rs)                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Commands:                                          â”‚ â”‚
â”‚ â”‚ â€¢ prepare, policy, manifest, proof, sign,          â”‚ â”‚
â”‚ â”‚   verifier, inspect, version, audit, lists         â”‚ â”‚
â”‚ â”‚ â€¢ audit tip, audit anchor   â˜… P0 â˜…                 â”‚ â”‚
â”‚ â”‚ â€¢ audit timestamp           â˜… P2 â˜…                 â”‚ â”‚
â”‚ â”‚ â€¢ audit verify-timestamp    â˜… P2 â˜…                 â”‚ â”‚
â”‚ â”‚ â€¢ lists sanctions-root      â˜… P1 â˜…                 â”‚ â”‚
â”‚ â”‚ â€¢ lists jurisdictions-root  â˜… P1 â˜…                 â”‚ â”‚
â”‚ â”‚ â€¢ registry add/list/verify  â˜… P2 â˜…                 â”‚ â”‚
â”‚ â”‚ â€¢ proof zk-build (+ sanctions-csv) â˜… P1 â˜…          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 6: Registry & Timestamp (P2) â˜… NEW â˜…             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ registry.rs:                                       â”‚ â”‚
â”‚ â”‚ â€¢ Registry (JSON-based proof metadata store)       â”‚ â”‚
â”‚ â”‚ â€¢ Timestamp (RFC3161-mock timestamping)            â”‚ â”‚
â”‚ â”‚ â€¢ File hashing (SHA3-256)                          â”‚ â”‚
â”‚ â”‚ â€¢ CRUD operations (add, list, verify)              â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 5: Lists Processing (P1) â˜… NEW â˜…                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ lists/sanctions.rs:                                â”‚ â”‚
â”‚ â”‚ â€¢ Sanctions CSV parsing                            â”‚ â”‚
â”‚ â”‚ â€¢ BLAKE3 Merkle roots for sanctions                â”‚ â”‚
â”‚ â”‚                                                    â”‚ â”‚
â”‚ â”‚ lists/jurisdictions.rs:                            â”‚ â”‚
â”‚ â”‚ â€¢ Jurisdictions CSV parsing                        â”‚ â”‚
â”‚ â”‚ â€¢ BLAKE3 Merkle roots for jurisdictions            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 4: Zero-Knowledge System (P0+P1)                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ zk_system.rs:                                      â”‚ â”‚
â”‚ â”‚ â€¢ ProofSystem Trait                                â”‚ â”‚
â”‚ â”‚ â€¢ Statement/Witness (+ optional roots P0+P1)       â”‚ â”‚
â”‚ â”‚ â€¢ SimplifiedZK Backend                             â”‚ â”‚
â”‚ â”‚ â€¢ sanctions_non_membership constraint â˜… P1 â˜…       â”‚ â”‚
â”‚ â”‚ â€¢ ZkProof Serialization (JSON/DAT)                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 3: Proof & Verification                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ proof_engine.rs: Structured proof building         â”‚ â”‚
â”‚ â”‚ verifier.rs: Package integrity & extraction        â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 2: Policy & Signing (P0)                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ policy.rs: Policy validation & hashing             â”‚ â”‚
â”‚ â”‚ â€¢ ubo_count_min â˜… P0 â˜…                             â”‚ â”‚
â”‚ â”‚ â€¢ require_statement_roots â˜… P0 â˜…                   â”‚ â”‚
â”‚ â”‚                                                    â”‚ â”‚
â”‚ â”‚ manifest.rs: Manifest building                     â”‚ â”‚
â”‚ â”‚ â€¢ TimeAnchor â˜… P0 â˜…                                â”‚ â”‚
â”‚ â”‚                                                    â”‚ â”‚
â”‚ â”‚ sign.rs: Ed25519 signing & verification            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 1: Commitment Engine (P0)                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ commitment.rs: BLAKE3 Merkle roots + counts        â”‚ â”‚
â”‚ â”‚ audit.rs: SHA3-256 hash chain                      â”‚ â”‚
â”‚ â”‚ â€¢ get_tip(), write_tip(), read_tip() â˜… P0 â˜…        â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 0: Data I/O                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ io.rs: CSV parsing (Suppliers, UBOs)               â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ Modul-Ãœbersicht

### Core Module (P0 Basis)

| Modul | Zeilen | Funktionen | Output |
|-------|--------|------------|--------|
| `io.rs` | 90 | CSV-Parsing | `Vec<Supplier>`, `Vec<Ubo>` |
| `commitment.rs` | 157 | BLAKE3 Merkle Roots + Counts | `Commitments` |
| `audit.rs` | 145 | SHA3-256 Hash Chain + Tip Management | `agent.audit.jsonl` |
| `policy.rs` | 210 | Policy Validation + P0 Extensions | `Policy` |
| `manifest.rs` | 230 | Manifest Building + TimeAnchor | `manifest.json` |
| `sign.rs` | 140 | Ed25519 Sign/Verify | `signature.json` |
| `proof_engine.rs` | 392 | Proof Build/Verify/Export | `proof.dat` |
| `verifier.rs` | 283 | Package Verification | Console output |

### P1 Module (Lists & Sanctions) â˜… NEW â˜…

| Modul | Zeilen | Funktionen | Output |
|-------|--------|------------|--------|
| `lists/mod.rs` | 8 | Module exports | - |
| `lists/sanctions.rs` | 285 | Sanctions CSV â†’ BLAKE3 Root | `sanctions.root` |
| `lists/jurisdictions.rs` | 275 | Jurisdictions CSV â†’ BLAKE3 Root | `jurisdictions.root` |
| `zk_system.rs` (erweitert) | 420 | ZK Prove/Verify + Sanctions Check | `zk_proof.dat` |

### P2 Module (Registry & Timestamp) â˜… NEW â˜…

| Modul | Zeilen | Funktionen | Output |
|-------|--------|------------|--------|
| `registry.rs` | 335 | Registry + Timestamp Management | `registry.json`, `timestamp.tsr` |
| `main.rs` (erweitert) | 1467 | +8 CLI-Commands (P0+P1+P2) | - |

**Gesamt:** ~4400 Zeilen Rust Code (ohne Tests)

**Test-Coverage:**
- **Unit-Tests:** 53 Tests (alle âœ…)
- **Module mit Tests:** 11
- **Test-Zeit:** < 0.01s

---

## ğŸ” Registry & Timestamp-Architektur

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             REGISTRY & TIMESTAMP ARCHITECTURE (P2)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. AUDIT CHAIN TIP MANAGEMENT                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  audit.rs (P0):                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â€¢ get_tip() â†’ returns current audit chain head            â”‚ â”‚
â”‚  â”‚ â€¢ write_tip(path) â†’ writes tip to file (hex)              â”‚ â”‚
â”‚  â”‚ â€¢ read_tip(path) â†’ reads tip from file                    â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚ Output: build/audit.head                                   â”‚ â”‚
â”‚  â”‚   Content: 0x83a8779dc1f6a3b0... (64 hex chars)           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. TIMESTAMP CREATION (audit timestamp)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  registry.rs::Timestamp (P2):                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Timestamp::create_mock(audit_tip_hex):                    â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚ 1. Get current timestamp (RFC3339)                         â”‚ â”‚
â”‚  â”‚ 2. Compute mock signature:                                 â”‚ â”‚
â”‚  â”‚    signature = hex(SHA3-256(audit_tip + timestamp))       â”‚ â”‚
â”‚  â”‚ 3. Create Timestamp object {                               â”‚ â”‚
â”‚  â”‚      version: "tsr.v1",                                    â”‚ â”‚
â”‚  â”‚      audit_tip_hex: "0x...",                               â”‚ â”‚
â”‚  â”‚      created_at: "2025-10-29T...",                         â”‚ â”‚
â”‚  â”‚      tsa: "local-mock",                                    â”‚ â”‚
â”‚  â”‚      signature: "abc123...",                               â”‚ â”‚
â”‚  â”‚      status: "ok"                                          â”‚ â”‚
â”‚  â”‚    }                                                       â”‚ â”‚
â”‚  â”‚ 4. Save to JSON file (timestamp.tsr)                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  Output: build/timestamp.tsr                                    â”‚
â”‚  Audit Event: "timestamp_generated"                             â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. TIMESTAMP VERIFICATION (audit verify-timestamp)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  registry.rs::Timestamp::verify(audit_tip_hex):                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 1. Check audit_tip matches                                 â”‚ â”‚
â”‚  â”‚ 2. Recompute signature:                                    â”‚ â”‚
â”‚  â”‚    expected_sig = hex(SHA3-256(audit_tip + created_at))   â”‚ â”‚
â”‚  â”‚ 3. Compare signatures:                                     â”‚ â”‚
â”‚  â”‚    signature == expected_sig ? âœ… : âŒ                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  Audit Event: "timestamp_verified"                              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. PROOF REGISTRY MANAGEMENT                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  registry.rs::Registry (P2):                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Registry {                                                 â”‚ â”‚
â”‚  â”‚   registry_version: "1.0",                                 â”‚ â”‚
â”‚  â”‚   entries: [                                               â”‚ â”‚
â”‚  â”‚     RegistryEntry {                                        â”‚ â”‚
â”‚  â”‚       id: "proof_001",                                     â”‚ â”‚
â”‚  â”‚       manifest_hash: "0xd490be94...",                      â”‚ â”‚
â”‚  â”‚       proof_hash: "0x83a8779d...",                         â”‚ â”‚
â”‚  â”‚       timestamp_file: Some("build/timestamp.tsr"),         â”‚ â”‚
â”‚  â”‚       registered_at: "2025-10-29T..."                      â”‚ â”‚
â”‚  â”‚     }                                                      â”‚ â”‚
â”‚  â”‚   ]                                                        â”‚ â”‚
â”‚  â”‚ }                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  Operations:                                                    â”‚
â”‚  â€¢ registry add: Adds proof with hashes                        â”‚
â”‚  â€¢ registry list: Shows all entries                            â”‚
â”‚  â€¢ registry verify: Checks hash match                          â”‚
â”‚                                                                 â”‚
â”‚  Output: build/registry.json (persistent)                       â”‚
â”‚  Audit Events: "registry_entry_added", "registry_verified"      â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Lists-Architektur (Sanctions/Jurisdictions)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           LISTS PROCESSING ARCHITECTURE (P1)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. SANCTIONS LIST PROCESSING                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Input: lists/eu_sanctions.csv                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ name,birthdate,nationality                                 â”‚ â”‚
â”‚  â”‚ Ali Hassan,1984-01-14,IR                                   â”‚ â”‚
â”‚  â”‚ Maria Petrova,1973-05-22,RU                                â”‚ â”‚
â”‚  â”‚ Viktor Sokolov,1965-11-30,RU                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  lists/sanctions.rs::compute_sanctions_root(csv_path):          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 1. Parse CSV â†’ Vec<SanctionsEntry>                        â”‚ â”‚
â”‚  â”‚ 2. For each entry:                                         â”‚ â”‚
â”‚  â”‚    hash = BLAKE3(name + "|" + birthdate + "|" + nation)   â”‚ â”‚
â”‚  â”‚ 3. Compute Merkle Root from hashes (BLAKE3)               â”‚ â”‚
â”‚  â”‚ 4. Return (root, entries)                                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  Output: build/sanctions.root                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ root: "0xdde3f2c9..."                                      â”‚ â”‚
â”‚  â”‚ count: 5                                                   â”‚ â”‚
â”‚  â”‚ source: "lists/eu_sanctions.csv"                           â”‚ â”‚
â”‚  â”‚ generated_at: "2025-10-29T..."                             â”‚ â”‚
â”‚  â”‚ algorithm: "BLAKE3"                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  Audit Event: "sanctions_root_generated"                        â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. JURISDICTIONS LIST PROCESSING                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Input: lists/highrisk.csv                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ iso_code,risk_level                                        â”‚ â”‚
â”‚  â”‚ IR,HIGH                                                    â”‚ â”‚
â”‚  â”‚ RU,HIGH                                                    â”‚ â”‚
â”‚  â”‚ DE,LOW                                                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  lists/jurisdictions.rs::compute_jurisdictions_root(csv_path):  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 1. Parse CSV â†’ Vec<JurisdictionEntry>                     â”‚ â”‚
â”‚  â”‚ 2. For each entry:                                         â”‚ â”‚
â”‚  â”‚    hash = BLAKE3(iso_code + "|" + risk_level)             â”‚ â”‚
â”‚  â”‚ 3. Compute Merkle Root from hashes (BLAKE3)               â”‚ â”‚
â”‚  â”‚ 4. Return (root, entries)                                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  Output: build/jurisdictions.root                               â”‚
â”‚  Audit Event: "jurisdictions_root_generated"                    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. ZK SANCTIONS CHECK INTEGRATION                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  zk_system.rs::SimplifiedZK (P1 Extension):                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Witness {                                                  â”‚ â”‚
â”‚  â”‚   sanctions_list: Option<Vec<String>>                      â”‚ â”‚
â”‚  â”‚ }                                                          â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚ Constraint: "sanctions_non_membership"                     â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚  â”‚ â”‚ if let Some(sanctions) = witness.sanctions_list {      â”‚â”‚ â”‚
â”‚  â”‚ â”‚   // Check no UBO hash is in sanctions list            â”‚â”‚ â”‚
â”‚  â”‚ â”‚   !witness.ubos.iter().any(|ubo| {                     â”‚â”‚ â”‚
â”‚  â”‚ â”‚     sanctions.contains(ubo)                            â”‚â”‚ â”‚
â”‚  â”‚ â”‚   })                                                   â”‚â”‚ â”‚
â”‚  â”‚ â”‚ } else {                                               â”‚â”‚ â”‚
â”‚  â”‚ â”‚   true  // No check if sanctions not provided         â”‚â”‚ â”‚
â”‚  â”‚ â”‚ }                                                      â”‚â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  CLI Integration:                                               â”‚
â”‚  â€¢ proof zk-build --sanctions-csv lists/eu_sanctions.csv        â”‚
â”‚  â€¢ Loads sanctions CSV, computes hashes, passes to witness      â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Datenfluss-Diagramme

### End-to-End Pipeline (P0 â†’ P1 â†’ P2)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FULL PIPELINE v0.6.0                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STEP 1: prepare
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input:  examples/suppliers.csv, examples/ubos.csv
Process: BLAKE3 Merkle Roots + Counts
Output: build/commitments.json
        build/agent.audit.jsonl (Event #1)

        â†“

STEP 2: policy validate
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input:  examples/policy.lksg.v1.yml
Process: Schema validation, SHA3-256 hash
Output: Policy Hash: 0xd490be94...
        build/agent.audit.jsonl (Event #2)

        â†“

STEP 3: manifest build
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input:  build/commitments.json, examples/policy.lksg.v1.yml
Process: Combine commitments + policy + audit tail
Output: build/manifest.json
        build/agent.audit.jsonl (Event #3)

        â†“

STEP 4: audit tip â˜… P0 â˜…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input:  build/agent.audit.jsonl
Process: Extract current audit chain head
Output: build/audit.head
        Content: 0x83a8779d... (64 hex)

        â†“

STEP 5: audit anchor â˜… P0 â˜…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input:  build/audit.head, build/manifest.json
Process: Set TimeAnchor in manifest
Output: build/manifest.json (with time_anchor)

        â†“

STEP 6: lists sanctions-root â˜… P1 â˜…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input:  lists/eu_sanctions.csv
Process: BLAKE3 Merkle Root computation
Output: build/sanctions.root
        build/agent.audit.jsonl (Event #4)

        â†“

STEP 7: lists jurisdictions-root â˜… P1 â˜…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input:  lists/highrisk.csv
Process: BLAKE3 Merkle Root computation
Output: build/jurisdictions.root
        build/agent.audit.jsonl (Event #5)

        â†“

STEP 8: proof zk-build (with sanctions) â˜… P1 â˜…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input:  build/manifest.json, policy, --sanctions-csv lists/eu_sanctions.csv
Process:
  1. Create Statement (PUBLIC):
     â€¢ policy_hash, company_root, constraints
     â€¢ sanctions_root: "0xdde3f2c9..."

  2. Create Witness (PRIVATE):
     â€¢ suppliers, ubos, counts
     â€¢ sanctions_list: [hashed sanctions]

  3. SimplifiedZK::prove():
     âœ… require_at_least_one_ubo
     âœ… supplier_count_max_10
     âœ… sanctions_non_membership (no UBO in sanctions)

Output: build/zk_proof.dat, build/zk_proof.json
        build/agent.audit.jsonl (Event #6)

        â†“

STEP 9: proof zk-verify â˜… P1 â˜…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input:  build/zk_proof.dat
Process: SimplifiedZK::verify()
Output: âœ… ZK-Proof ist gÃ¼ltig!
        build/agent.audit.jsonl (Event #7)

        â†“

STEP 10: audit timestamp â˜… P2 â˜…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input:  build/audit.head
Process: Timestamp::create_mock(audit_tip)
Output: build/timestamp.tsr {
          version: "tsr.v1",
          audit_tip_hex: "0x83a8779d...",
          created_at: "2025-10-29T...",
          tsa: "local-mock",
          signature: "abc123...",
          status: "ok"
        }
        build/agent.audit.jsonl (Event #8)

        â†“

STEP 11: audit verify-timestamp â˜… P2 â˜…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input:  build/audit.head, build/timestamp.tsr
Process: Timestamp::verify(audit_tip)
Output: âœ… Timestamp valid
        build/agent.audit.jsonl (Event #9)

        â†“

STEP 12: registry add â˜… P2 â˜…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input:  build/manifest.json, build/zk_proof.dat,
        build/timestamp.tsr
Process:
  1. Compute SHA3-256(manifest) â†’ 0xd490be94...
  2. Compute SHA3-256(proof) â†’ 0x83a8779d...
  3. Create RegistryEntry {
       id: "proof_001",
       manifest_hash, proof_hash,
       timestamp_file: "build/timestamp.tsr",
       registered_at: "2025-10-29T..."
     }
  4. Save to registry.json

Output: build/registry.json
        build/agent.audit.jsonl (Event #10)

        â†“

STEP 13: registry list â˜… P2 â˜…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input:  build/registry.json
Process: Display all entries
Output: Console:
        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        Proofs in local registry (build/registry.json)
        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        #1  Manifest: 0xd490be94â€¦  Proof: 0x83a8779dâ€¦
            Date: 2025-10-29T...
            Timestamp: build/timestamp.tsr
        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        Total: 1 EintrÃ¤ge

        â†“

STEP 14: registry verify â˜… P2 â˜…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input:  build/manifest.json, build/zk_proof.dat,
        build/registry.json
Process:
  1. Compute hashes
  2. Find entry in registry
  3. Verify match

Output: âœ… Entry verified in registry
        ID: proof_001
        Registered: 2025-10-29T...
        Timestamp: build/timestamp.tsr
        build/agent.audit.jsonl (Event #11)
```

---

## ğŸ–¥ï¸ CLI-Kommando-Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CLI COMMAND TREE v0.6.0                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

cap-agent
â”‚
â”œâ”€â”€ prepare                    (Base)
â”‚   â””â”€â”€ --suppliers <CSV> --ubos <CSV>
â”‚       â†’ build/commitments.json
â”‚
â”œâ”€â”€ inspect                    (Base)
â”‚   â””â”€â”€ <commitments.json>
â”‚       â†’ Console output
â”‚
â”œâ”€â”€ version                    (Base)
â”‚   â†’ "cap-agent v0.6.0"
â”‚
â”œâ”€â”€ policy                     (Base)
â”‚   â”œâ”€â”€ validate
â”‚   â”‚   â””â”€â”€ --file <policy.yml>
â”‚   â”‚       â†’ Policy hash
â”‚   â””â”€â”€ show
â”‚       â””â”€â”€ --file <policy.yml>
â”‚           â†’ Policy details
â”‚
â”œâ”€â”€ manifest                   (Base)
â”‚   â””â”€â”€ build
â”‚       â””â”€â”€ --policy <policy.yml> [--out <path>]
â”‚           â†’ build/manifest.json
â”‚
â”œâ”€â”€ audit                      (Base + P0 + P2)
â”‚   â”œâ”€â”€ tip                    â˜… P0 â˜…
â”‚   â”‚   â””â”€â”€ [--out <path>]
â”‚   â”‚       â†’ build/audit.head
â”‚   â”‚
â”‚   â”œâ”€â”€ anchor                 â˜… P0 â˜…
â”‚   â”‚   â””â”€â”€ --kind <type> --reference <ref>
â”‚   â”‚       --manifest-in <in> --manifest-out <out>
â”‚   â”‚       â†’ manifest with time_anchor
â”‚   â”‚
â”‚   â”œâ”€â”€ timestamp              â˜… P2 â˜…
â”‚   â”‚   â””â”€â”€ --head <audit.head> [--out <path>]
â”‚   â”‚       [--mock] [--tsa-url <url>]
â”‚   â”‚       â†’ build/timestamp.tsr
â”‚   â”‚
â”‚   â””â”€â”€ verify-timestamp       â˜… P2 â˜…
â”‚       â””â”€â”€ --head <audit.head> --timestamp <timestamp.tsr>
â”‚           â†’ Verification result
â”‚
â”œâ”€â”€ lists                      (P1) â˜… NEW â˜…
â”‚   â”œâ”€â”€ sanctions-root
â”‚   â”‚   â””â”€â”€ --csv <sanctions.csv> [--out <path>]
â”‚   â”‚       â†’ build/sanctions.root
â”‚   â”‚
â”‚   â””â”€â”€ jurisdictions-root
â”‚       â””â”€â”€ --csv <jurisdictions.csv> [--out <path>]
â”‚           â†’ build/jurisdictions.root
â”‚
â”œâ”€â”€ registry                   (P2) â˜… NEW â˜…
â”‚   â”œâ”€â”€ add
â”‚   â”‚   â””â”€â”€ --manifest <manifest.json> --proof <proof.dat>
â”‚   â”‚       [--timestamp <timestamp.tsr>] [--registry <path>]
â”‚   â”‚       â†’ build/registry.json
â”‚   â”‚
â”‚   â”œâ”€â”€ list
â”‚   â”‚   â””â”€â”€ [--registry <path>]
â”‚   â”‚       â†’ Console list of all entries
â”‚   â”‚
â”‚   â””â”€â”€ verify
â”‚       â””â”€â”€ --manifest <manifest.json> --proof <proof.dat>
â”‚           [--registry <path>]
â”‚           â†’ Verification result
â”‚
â”œâ”€â”€ proof                      (Base + P1)
â”‚   â”œâ”€â”€ mock                   (Base)
â”‚   â”‚   â””â”€â”€ --policy <policy.yml> --manifest <manifest.json>
â”‚   â”‚       â†’ build/mock_proof.json
â”‚   â”‚
â”‚   â”œâ”€â”€ build                  (Base)
â”‚   â”‚   â””â”€â”€ --policy <policy.yml> --manifest <manifest.json>
â”‚   â”‚       â†’ build/proof.dat
â”‚   â”‚
â”‚   â”œâ”€â”€ verify                 (Base)
â”‚   â”‚   â””â”€â”€ --proof <proof.dat> --manifest <manifest.json>
â”‚   â”‚       â†’ Verification result
â”‚   â”‚
â”‚   â”œâ”€â”€ export                 (Base)
â”‚   â”‚   â””â”€â”€ --manifest <manifest.json> --proof <proof.dat>
â”‚   â”‚       [--signature <signature.json>] [--out <dir>]
â”‚   â”‚       â†’ proof_package/
â”‚   â”‚
â”‚   â”œâ”€â”€ zk-build               (Base + P1)
â”‚   â”‚   â””â”€â”€ --policy <policy.yml> --manifest <manifest.json>
â”‚   â”‚       [--sanctions-root <root>] [--jurisdiction-root <root>]
â”‚   â”‚       [--sanctions-csv <csv>] â˜… P1 â˜…  [--out <path>]
â”‚   â”‚       â†’ build/zk_proof.dat
â”‚   â”‚
â”‚   â”œâ”€â”€ zk-verify              (Base)
â”‚   â”‚   â””â”€â”€ --proof <zk_proof.dat>
â”‚   â”‚       â†’ ZK verification result
â”‚   â”‚
â”‚   â””â”€â”€ bench                  (Base)
â”‚       â””â”€â”€ --policy <policy.yml> --manifest <manifest.json>
â”‚           [--iterations <N>]
â”‚           â†’ Performance metrics
â”‚
â”œâ”€â”€ sign                       (Base)
â”‚   â”œâ”€â”€ keygen
â”‚   â”‚   â””â”€â”€ [--dir <path>]
â”‚   â”‚       â†’ company.ed25519, company.pub
â”‚   â”‚
â”‚   â”œâ”€â”€ manifest
â”‚   â”‚   â””â”€â”€ --manifest-in <manifest.json> --key <privkey>
â”‚   â”‚       --out <signature.json>
â”‚   â”‚       â†’ signature.json
â”‚   â”‚
â”‚   â””â”€â”€ verify
â”‚       â””â”€â”€ --signature <signature.json> --key <pubkey>
â”‚           â†’ Verification result
â”‚
â””â”€â”€ verifier                   (Base)
    â”œâ”€â”€ run
    â”‚   â””â”€â”€ --package <proof_package/>
    â”‚       â†’ VerificationResult
    â”‚
    â”œâ”€â”€ extract
    â”‚   â””â”€â”€ --package <proof_package/>
    â”‚       â†’ Package summary
    â”‚
    â””â”€â”€ audit
        â””â”€â”€ --package <proof_package/>
            â†’ Audit trail info
```

**Gesamt:** 27 CLI-Commands (+8 neue in P0+P1+P2)

---

## ğŸ“„ Datenformate

### registry.json (P2)

```json
{
  "registry_version": "1.0",
  "entries": [
    {
      "id": "proof_001",
      "manifest_hash": "0xd490be94abc123...",
      "proof_hash": "0x83a8779ddef456...",
      "timestamp_file": "build/timestamp.tsr",
      "registered_at": "2025-10-29T15:30:00Z"
    }
  ]
}
```

### timestamp.tsr (P2)

```json
{
  "version": "tsr.v1",
  "audit_tip_hex": "0x83a8779dc1f6a3b0...",
  "created_at": "2025-10-29T15:30:00Z",
  "tsa": "local-mock",
  "signature": "abc123def456...",
  "status": "ok"
}
```

### sanctions.root (P1)

```
root: "0xdde3f2c9a1b2..."
count: 5
source: "lists/eu_sanctions.csv"
generated_at: "2025-10-29T15:00:00Z"
algorithm: "BLAKE3"
```

### manifest.json (P0 Extended)

```json
{
  "version": "manifest.v0",
  "created_at": "2025-10-29T...",
  "supplier_root": "0x...",
  "ubo_root": "0x...",
  "company_commitment_root": "0x...",
  "policy": {
    "name": "LkSG Policy",
    "version": "lksg.v1",
    "hash": "0x..."
  },
  "audit": {
    "tail_digest": "0x...",
    "events_count": 20
  },
  "time_anchor": {
    "kind": "tsa",
    "reference": "build/timestamp.tsr",
    "audit_tip_hex": "0x...",
    "created_at": "2025-10-29T..."
  },
  "proof": {
    "proof_type": "zk",
    "status": "ok"
  },
  "signatures": []
}
```

---

## ğŸ§ª Test-Coverage

### Unit-Tests

**Gesamt:** 53 Tests âœ…

| Modul | Tests | Status |
|-------|-------|--------|
| `io::tests` | 2 | âœ… |
| `commitment::tests` | 3 | âœ… |
| `audit::tests` | 4 | âœ… (+ tip tests P0) |
| `policy::tests` | 6 | âœ… (+ P0 extensions) |
| `manifest::tests` | 3 | âœ… (+ time_anchor P0) |
| `proof_mock::tests` | 3 | âœ… |
| `proof_engine::tests` | 3 | âœ… |
| `verifier::tests` | 3 | âœ… |
| `sign::tests` | 3 | âœ… |
| `zk_system::tests` | 6 | âœ… (+ sanctions P1) |
| **`lists/sanctions::tests`** â˜… P1 â˜… | **3** | **âœ…** |
| **`lists/jurisdictions::tests`** â˜… P1 â˜… | **3** | **âœ…** |
| **`registry::tests`** â˜… P2 â˜… | **9** | **âœ…** |

#### P2 Registry Tests

| Test | Beschreibung | Status |
|------|--------------|--------|
| `test_registry_new` | Neue Registry erstellen | âœ… |
| `test_registry_add_entry` | Eintrag hinzufÃ¼gen | âœ… |
| `test_registry_find_entry` | Eintrag suchen | âœ… |
| `test_registry_verify_entry` | Eintrag verifizieren | âœ… |
| `test_registry_save_load` | Registry Serialisierung | âœ… |
| `test_timestamp_create_mock` | Mock-Timestamp erstellen | âœ… |
| `test_timestamp_verify_ok` | Timestamp verifizieren (OK) | âœ… |
| `test_timestamp_verify_fail` | Timestamp verifizieren (FAIL) | âœ… |
| `test_timestamp_save_load` | Timestamp Serialisierung | âœ… |

### Clippy

```
cargo clippy -- -D warnings
âœ… 0 Warnings
âœ… All checks passed
```

---

## ğŸ“ˆ Statistiken

| Metrik | v0.4.0 | v0.6.0 | Delta |
|--------|--------|--------|-------|
| **Module** | 10 | 13 | +3 (lists/*, registry) |
| **Zeilen Code** | ~2900 | ~4400 | +1500 |
| **Unit Tests** | 30 | 53 | +23 |
| **CLI Commands** | 19 | 27 | +8 |
| **Dokumentation** | 117 KB | 165 KB | +48 KB |
| **Build Time** | 12s | 14s | +2s |
| **Test Time** | 0.01s | 0.01s | 0s |

---

## ğŸ¯ Zusammenfassung

### Was ist neu in v0.6.0?

#### P0: Quick Wins (v0.4.1) âœ…
- **Audit Tip Management:** `audit tip`, `audit anchor`
- **TimeAnchor in Manifest:** Externe Zeitverankerung
- **Policy Extensions:** `ubo_count_min`, `require_statement_roots`
- **Statement Roots:** Optionale `sanctions_root`, `jurisdiction_root` in ZK-Statement

#### P1: Sanctions & Jurisdictions (v0.5.0) âœ…
- **Lists Module:**
  - `lists/sanctions.rs` - Sanctions CSV â†’ BLAKE3 Merkle Root
  - `lists/jurisdictions.rs` - Jurisdictions CSV â†’ BLAKE3 Merkle Root
- **ZK Sanctions Check:**
  - Witness mit `sanctions_list`
  - Neue Constraint: `sanctions_non_membership`
- **CLI Integration:**
  - `lists sanctions-root`, `lists jurisdictions-root`
  - `proof zk-build --sanctions-csv`

#### P2: Timestamp & Registry (v0.6.0) âœ…
- **Registry Module:**
  - JSON-basierte Proof-Registry
  - SHA3-256 File-Hashing
  - CRUD-Operationen (add, list, verify)
- **Timestamp Module:**
  - RFC3161-Mock-Timestamps
  - Audit-Tip-Verankerung
  - Roundtrip-Verifikation
- **CLI Integration:**
  - `audit timestamp`, `audit verify-timestamp`
  - `registry add`, `registry list`, `registry verify`

---

### Architektur-Highlights

#### 1. Modulare Schichtenarchitektur (7 Layer)
```
CLI â†’ Registry â†’ Lists â†’ ZK-System â†’ Proof â†’ Policy â†’ Commitment â†’ I/O
```

#### 2. Hash-Chain Audit Trail
```
SHA3-256 Chain: E0 â†’ E1 â†’ E2 â†’ ... â†’ En
Events: prepare, policy_validate, manifest_build, zk_proof_generated,
        sanctions_root_generated, timestamp_generated, registry_entry_added
```

#### 3. Timestamp-Verankerung (Mock)
```
signature = hex(SHA3-256(audit_tip + timestamp))
verify: recompute signature and compare
```

#### 4. Proof Registry (JSON-persistiert)
```
RegistryEntry {
  id: "proof_001",
  manifest_hash: SHA3-256(manifest.json),
  proof_hash: SHA3-256(zk_proof.dat),
  timestamp_file: "timestamp.tsr",
  registered_at: RFC3339
}
```

#### 5. Lists-Integration (BLAKE3)
```
Sanctions: hash(name|birthdate|nationality) â†’ Merkle Root
Jurisdictions: hash(iso_code|risk_level) â†’ Merkle Root
ZK-Check: sanctions_non_membership (no UBO in sanctions)
```

---

### PRD Akzeptanzkriterien

#### P0: Quick Wins âœ…
- âœ… `audit tip` schreibt Audit-Head in Datei
- âœ… `audit anchor` setzt TimeAnchor im Manifest
- âœ… Policy-Erweiterungen (`ubo_count_min`, `require_statement_roots`)
- âœ… Statement mit optionalen Roots (`sanctions_root`, `jurisdiction_root`)
- âœ… Tests grÃ¼n (44/44 â†’ 53/53), Clippy clean

#### P1: Sanctions & Jurisdictions âœ…
- âœ… Lists-Modul mit Sanctions/Jurisdictions CSV-Processing
- âœ… BLAKE3 Merkle Roots fÃ¼r beide Listentypen
- âœ… ZK-Witness mit `sanctions_list`
- âœ… Constraint `sanctions_non_membership` implementiert
- âœ… CLI-Commands (`lists sanctions-root`, `lists jurisdictions-root`)
- âœ… Proof zk-build mit `--sanctions-csv`
- âœ… Tests grÃ¼n (44/44 â†’ 53/53), Clippy clean

#### P2: Timestamp & Registry âœ…
- âœ… Registry-Modul mit JSON-Persistenz
- âœ… Timestamp-Modul mit RFC3161-Mock
- âœ… CLI-Commands (audit timestamp/verify-timestamp, registry add/list/verify)
- âœ… Audit-Events fÃ¼r alle Operationen
- âœ… SHA3-256 File-Hashing fÃ¼r Integrity-Checks
- âœ… Tests grÃ¼n (53/53), Clippy clean

**Definition of Done:** âœ… ERFÃœLLT

---

### NÃ¤chste Schritte (v0.7.0+)

**GemÃ¤ÃŸ PRD-Roadmap:**
1. **Echte TSA-Integration** (RFC3161 mit DigiCert/Let's Encrypt)
2. **Blockchain-Anchoring** (Ethereum/Solana fÃ¼r Registry)
3. **SQLite-Registry** (statt JSON fÃ¼r Performance)
4. **Recursive Proofs** (Proof-of-Proofs, Nova)
5. **Halo2-Backend** (Echtes Zero-Knowledge statt SimplifiedZK)
6. **Web-Verifier** (WASM-basierte Browser-Verifikation)

---

## ğŸ“š Referenzen

- **P0 (v0.4.1):** Quick Wins (Timestamp Anchors, Statement Roots, Mini-Policy)
- **P1 (v0.5.0):** Sanctions & Jurisdictions (Lists Processing, Mock ZK-Checks)
- **P2 (v0.6.0):** Timestamp & Registry (RFC3161-Mock, Proof Registry)

**Dependencies:**
- **blake3:** Merkle Root Computation
- **sha3:** Audit Chain + File Hashing
- **ed25519-dalek:** Digital Signatures
- **serde/serde_json:** Serialization
- **chrono:** RFC3339 Timestamps
- **clap:** CLI Framework
- **csv:** CSV Parsing

---

Â© 2025 Confidential Assurance Protocol â€“ Core Engineering
**Version:** 0.6.0 (P0 + P1 + P2 â€“ Timestamp & Registry Integration)
**Status:** Production-Ready for Architecture Demo & Extension
